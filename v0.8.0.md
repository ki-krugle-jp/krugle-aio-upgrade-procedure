
## Login to the server and become root user.

```bash
sudo -i
```

## Stop krugle and shasta services

```bash
systemctl stop krugle.service
systemctl stop shasta.service
```


## Backup local project folders and files

```bash
mkdir -p /data/backup
cp -r /opt/krugle/scmi/data /data/backup/
```

## Verify backup contents

```bash
ls -lR /data/backup/data

```

## Download AIO Image

Define username(dluser) and password(dlpass) for download site.

```bash
dluser="<username>"
dlpass="<password>"
```

Download image from https://downloads.krugle.org/ to /root/ directory.

```bash
wget --user=${dluser}  --password=${dlpass} https://downloads.krugle.org/Krugle-AiO-installer-enterprise-0.8.0-20260108T051336.tgz
wget --user=${dluser}  --password=${dlpass} https://downloads.krugle.org/Krugle-AiO-installer-enterprise-0.8.0-20260108T051336.tgz.md5sum.txt
```

## Check md5 checksum
```bash
md5sum -c Krugle-AiO-installer-enterprise-0.8.0-20260108T051336.tgz.md5sum.txt

### sample
root@demo1-aio:~# md5sum -c Krugle-AiO-installer-enterprise-0.8.0-20260108T051336.tgz.md5sum.txt
Krugle-AiO-installer-enterprise-0.8.0-20260108T051336.tgz: OK
root@demo1-aio:~#

```

## Delete old installer 

```bash

cd /root
rm -rf krugle-aio-installer

```

## Extract AIO installer tarball
```bash
tar xvzf Krugle-AiO-installer-enterprise-0.8.0-20260108T051336.tgz
```


#### Copy certificate and key to SSL directory

```bash
cp -v /root/server.crt /root/krugle-aio-installer/krugle/kng/kse/ssl/server.crt
cp -v /root/server.key /root/krugle-aio-installer/krugle/kng/kse/ssl/server.key
```

## Uninstall krugle & shasta services

### Executes uninstall.sh
```bash
cd /opt/krugle/

```

### Select uninstaller option: Enter or Input N

```bash
Remove Krugle data? (Y/N, default: N): <Enter>
```

### Check Uninstall complete message

```bash
>>> Uninstall complete.
```

## Reboot server (Not Mandatory but recommended)

```bash
systemctl reboot
```


## Login to the server and become root user.

```bash
sudo -i
```

## Executes AIO Installer

```bash
cd /root/krugle-aio-installer
./install.sh

```

## Select installer option


### README.md: Enter or Input Y
```bash
 - Make sure you have read the README.md file before using this installer.
Have you read the README.md? (Y/N, default: Y): <Enter>
```

### KrugleAI Web UI: Enter or Input Y
```bash
Enable KrugleAI Web UI? (default: Y): <Enter>
```

### KrugleAI MRE: Enter or Input Y
```bash
Enable KrugleAI MRE (Model Runtime Environment, formerly known as Shasta)? (default: Y):
```

```bash
Who should set up the firewall?

    - a. Let Krugle set up the firewall rules automatically
    - b. I want to set up the firewall myself


    (default: a): <Enter>
```

## Verify krugle.service and shasta.service

```bash
systemctl status krugle.service
systemctl status shasta.service

### sample
root@demo1-aio:~# systemctl status krugle.service --no-pager
● krugle.service - KrugleAI - AiO
     Loaded: loaded (/etc/systemd/system/krugle.service; enabled; preset: enabled)
     Active: active (exited) since Wed 2026-01-21 16:21:11 JST; 4min 44s ago
       Docs: https://krugle.co.jp
   Main PID: 4591 (code=exited, status=0/SUCCESS)
        CPU: 227ms

Jan 21 16:21:10 demo1-aio.krugle.jp docker[4617]:  Container krugle_hub_container  Started
Jan 21 16:21:10 demo1-aio.krugle.jp docker[4617]:  Container krugle_k7_container  Starting
Jan 21 16:21:11 demo1-aio.krugle.jp docker[4617]:  Container krugle_k7_container  Started
Jan 21 16:21:11 demo1-aio.krugle.jp docker[4617]:  Container krugle_ai_core  Starting
Jan 21 16:21:11 demo1-aio.krugle.jp docker[4617]:  Container krugle_ai_core  Started
Jan 21 16:21:11 demo1-aio.krugle.jp docker[4617]:  Container krugle_ai_admin_ui  Starting
Jan 21 16:21:11 demo1-aio.krugle.jp docker[4617]:  Container krugle_proxy_container  Starting
Jan 21 16:21:11 demo1-aio.krugle.jp docker[4617]:  Container krugle_ai_admin_ui  Started
Jan 21 16:21:11 demo1-aio.krugle.jp docker[4617]:  Container krugle_proxy_container  Started
Jan 21 16:21:11 demo1-aio.krugle.jp systemd[1]: Finished krugle.service - KrugleAI - AiO.
root@demo1-aio:~#
root@demo1-aio:~#
root@demo1-aio:~# systemctl status shasta.service --no-pager
● shasta.service - Shasta Service
     Loaded: loaded (/etc/systemd/system/shasta.service; enabled; preset: enabled)
     Active: active (running) since Wed 2026-01-21 16:21:52 JST; 4min 7s ago
   Main PID: 7574 (shasta)
      Tasks: 73 (limit: 154270)
     Memory: 22.8G (peak: 22.8G)
        CPU: 1min 16.942s
     CGroup: /system.slice/shasta.service
             tq7574 /usr/local/bin/shasta serve
             tq7953 /usr/local/bin/shasta runner --shasta-engine --model /root/.shasta/models/blobs/sha256-b779ea8c7d13f7e1578014ab4b15e9437392936cc9d46ab1b83ba34 …
             mq8082 /usr/local/bin/shasta runner --model /root/.shasta/models/blobs/sha256-a371b2da357deed0d86667d7561e7bd96e3aeeac1e42d370ffb70ac5caf3f6a1 --port …

Jan 21 16:21:52 demo1-aio.krugle.jp systemd[1]: Started shasta.service - Shasta Service.
root@demo1-aio:~#

```

## Restore Data from Backup

```bash
cp -vr /data/backup/data /opt/krugle/scmi/ 
```